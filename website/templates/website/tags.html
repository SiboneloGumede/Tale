{%extends 'website/base.html'%}
{%load static%}

{%block title%}Tale{%endblock%}

{%block content%}
<main id="content" role="main">

  <!-- Hero -->
  <div class="overflow-hidden">
    <div class="container content-space-t-4 content-space-b-3">
      <div class="row justify-content-lg-between align-items-md-center">
        <div class="col-md-6 col-lg-6 mb-7 mb-md-0">
          <!-- Heading -->
          <div class="mb-5">
            <h1 class="display-5 mb-3">
              <span class="text-primary text-highlight-warning">
                  <span class="js-typedjs"
                        data-hs-typed-options='{
                          "strings": ["Stories and ideas"],
                          "typeSpeed": 90,
                          "loop": true,
                          "backSpeed": 30,
                          "backDelay": 2500
                        }'></span>
                </span> setting Africa ablaze.</h1>
          </div>
          <!-- End Heading -->
          {%if request.user.is_authenticated%}
          <div class="d-grid d-sm-flex gap-3">
            <a class="btn btn-danger btn-transition" href="{%url 'website:dashboard'%}">DASHBOARD</a>
          </div>
          {%else%}
          <div class="d-grid d-sm-flex gap-3">
            <a class="btn btn-danger btn-transition" href="#sign-up">SIGN UP</a>
          </div>
          {%endif%}
        </div>
        <!-- End Col -->

        <div class="col-md-6">
          <div class="position-relative">
            <img class="img-fluid rounded-2" src="{%static 'assets/img/tale/home-page.svg' %}" alt="Image Description">
          </div>
        </div>
        <!-- End Col -->
      </div>
      <!-- End Row -->
    </div>
  </div>
  <!-- End Hero -->

  <!-- Card Grid -->
  <div class="container content-space-2 content-space-lg-3">
    <div class="row justify-content-lg-between">
      <div class="col-lg-8 mb-10 mb-lg-0">
        <div class="d-grid gap-7 mb-7">
          {%for publication in publications%}
          <!-- Card -->
          <div class="card card-flush card-stretched-vertical">
            <div class="row">
              <div class="col-sm-5">
                <img class="card-img" src="{{publication.get_image}}" alt="Image Description">
              </div>
              <!-- End Col -->

              <div class="col-sm-7">
                <!-- Card Body -->
                <div class="card-body">
                  

                  <h3 class="card-title">
                    <a class="text-dark" href="{%url 'website:article-select' publication.pk publication.slug%}">{{publication.title}}</a>
                  </h3>
                  
                  <p class="card-text">{{publication.blurb}}</p>
                  
                  <!-- Card Footer -->
                  <div class="card-footer">
                    <div class="d-flex">
                      <div class="flex-shrink-0">
                        <a class="avatar avatar-circle" href="{%url 'website:author-select' publication.user.pk publication.user.username%}">
                          <img class="avatar-img" src="{{publication.user.gravatar}}" alt="Image Description">
                        </a>
                      </div>
                    
                      <div class="flex-grow-1 ms-3">
                        <a class="card-link link-dark" href="{%url 'website:author-select' publication.user.pk publication.user.username%}">{{publication.user.get_full_name}}</a>
                        <p class="card-text small">{{publication.date|date:'f d, Y'}}</p>
                      </div>
                    </div>
                  </div>
                  <!-- End Card Footer -->
                </div>
                <!-- End Card Body -->
              </div>
              <!-- End Col -->
            </div>
            <!-- End Row -->
          </div>
          <!-- End Card -->
          {%endfor%}
        </div>

        <!-- Sticky Block End Point -->
        <div id="stickyBlockEndPoint"></div>

        <!-- Pagination -->
        <nav aria-label="Page navigation">
          <ul class="pagination">
            {%if publications.has_previous%}
            <li class="page-item">
              <a class="page-link" href="?page={{ publications.previous_page_number }}" aria-label="Previous">
                <span aria-hidden="true">
                  <i class="bi-chevron-double-left small"></i>
                </span>
              </a>
            </li>
            {%else%}
            <li class="page-item disabled">
              <a class="page-link" href="#" aria-label="Previous">
                <span aria-hidden="true">
                  <i class="bi-chevron-double-left small"></i>
                </span>
              </a>
            </li>
            {%endif%}

            {%for pages in range%}
              {%if publications.number == forloop.counter%}
                <li class="page-item active"><a class="page-link" href="?page={{forloop.counter}}">{{forloop.counter}}</a></li>
              {%else%}
                <li class="page-item"><a class="page-link" href="?page={{forloop.counter}}">{{forloop.counter}}</a></li>
              {%endif%}
            {%endfor%}
           
            {%if publications.has_next%}
            <li class="page-item">
              <a class="page-link" href="?page={{ publications.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">
                  <i class="bi-chevron-double-right small"></i>
                </span>
              </a>
            </li>
            {%else%}
            <li class="page-item disabled">
              <a class="page-link" href="#" aria-label="Next">
                <span aria-hidden="true">
                  <i class="bi-chevron-double-right small"></i>
                </span>
              </a>
            </li>
            {%endif%}
          </ul>
        </nav>
        <!-- End Pagination -->
      </div>
      <!-- End Col -->

      <div class="col-lg-3">
        <div class="mb-7">
          <div class="mb-3">
            <h3>Search</h3>
          </div>

          <!-- Form -->
          <form action="{%url 'website:search-publication'%}" id="search-form" method="POST">
            {%csrf_token%}
            <div class="mb-2">
              <input type="text" class="form-control" name="search" id="id_search" placeholder="Search" aria-label="Search" required>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-primary" id="search-sub">Search</button>
            </div>
          </form>
          <!-- End Form -->
        </div>

        <div class="mb-7">
          <div class="mb-3">
            <h3>Newsletter</h3>
          </div>

          <!-- Form -->
          <form action="{%url 'website:landing'%}" id="sign-up-form" method="POST">
            {%csrf_token%}
            <div class="mb-2">
              <input type="text" class="form-control" name="email" id="id_email" placeholder="Enter email" aria-label="Enter email" required>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-primary" id="sub">Subscribe</button>
            </div>
          </form>
          <!-- End Form -->

          <p class="form-text">Get the latest news and articles from Tale.</p>
        </div>

        <!-- Sticky Block Start Point -->
        <div id="stickyBlockStartPoint"></div>

        <div class="js-sticky-block"
             data-hs-sticky-block-options='{
               "parentSelector": "#stickyBlockStartPoint",
               "targetSelector": "#header",
               "breakpoint": "md",
               "startPoint": "#stickyBlockStartPoint",
               "endPoint": "#stickyBlockEndPoint",
               "stickyOffsetTop": 80
             }'>
          <div class="mb-7">
            <div class="mb-3">
              <h3>Top authors</h3>
            </div>

            <div class="d-grid gap-2">
              {%for author in authors%}
              <!-- Card -->
              <a class="d-block" href="{%url 'website:author-select' author.pk author.username%}">
                <div class="d-flex align-items-center">
                  <div class="flex-shrink-0">
                    <div class="avatar avatar-lg">
                      <img class="avatar-img" src="{{author.gravatar}}" alt="Image Description">
                    </div>
                  </div>
                  <div class="flex-grow-1 ms-3">
                    <h5 class="text-inherit mb-0">{{author.get_full_name}}</h5>
                  </div>
                </div>
              </a>
              <!-- End Card -->
              {%endfor%}

            </div>
          </div>

          <div class="mb-7">
            <div class="mb-3">
              <h3>Tags</h3>
            </div>
            {%for tag in tags%}
            <a class="btn btn-soft-secondary btn-xs mb-1" href="{%url 'website:tags' tag%}">{{tag}}</a>
            {%endfor%}
            
          </div>
        </div>
      </div>
      <!-- End Col -->
      <!-- End Col -->
    </div>
    <!-- End Row -->
  </div>
  <!-- End Card Grid -->

</main>


<script type="text/javascript">
  var element = document.getElementById("id_home");
  element.classList.add("active");
</script>

{%endblock%}





